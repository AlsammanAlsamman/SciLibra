#:kivy 1.11.0
#:import Factory kivy.factory.Factory

############# Menu Bar ################

# load files from kv folder

#:include kv/MenuBar.kv
#:include kv/AboutSciLibra.kv
#:include kv/SearchScreen.kv
#:include kv/PopUpMessage.kv




<YesNoDialog>:
    size_hint: None, None
    size: 400, 200
    title: 'Message'
    auto_dismiss: False
    BoxLayout:
        orientation: 'vertical'
        ScrollView:
            pos: 0, 0
            scroll_y: 0
            scroll_type: ['bars', 'content']
            TextInput:
                multiline: True
                text: root.message
                readonly: True
                # grey
                background_color: 0.8, 0.8, 0.8, 1
        GridLayout:
            cols: 2
            rows: 1
            size_hint_y: None
            height: 30
            Button:
                text: 'Yes'
                on_release: root.yes()
            # copy message to clipboard
            Button:
                text: 'No'
                on_release: root.no()



<MainScreen>:
    name: 'main'
    article_info: article_info
    menu_bar: menu_bar
    # tree_view: tree_view
    # list_tool: list_tool
    # scroll_tool: scroll_tool
    GridLayout:
        cols: 1
        rows: 2
        MenuBar:
            height: 40
            id: menu_bar
            pos: 0, root.height - self.height
        GridLayout:
            cols: 2
            rows: 1
            LibraryListView:
                id: library_view
            # Article Info
            GridLayout:
                cols: 1
                rows: 2
                RstDocument:
                    id: article_info
                    text: 'Please select an article'
                # Article Actions
                BoxLayout:
                    size_hint_y: None
                    height: 50
                    width: 120
                    Button:
                        # back ground image
                        text: 'Open'
                        #rgb(173,255,47)
                        background_color: 0.678, 0.847, 0.902, 1
                        on_release: root.parent.open_article()
                    Button:
                        text: 'Edit'
                        #rgb(173,255,47)
                        background_color: 0.678, 0.847, 0.902, 1
                        # on_release: root.edit_article()
                        on_release: root.edit_article()
                    Button:
                        text: 'Delete'
                        #rgb(173,255,47)
                        background_color: 0.678, 0.847, 0.902, 1
                        on_release: root.delete_article()
<LibraryListView>:
    list_tool: list_tool
    ScrollView:
        pos: 0, 0
        scroll_y: 1
        scroll_type: ['bars', 'content']
        canvas.before:
            Color:
                rgba: 0.6, 0.2, 0.2, 1
            Rectangle:
                pos: self.pos
                size: self.size
        do_scroll_x: False
        do_scroll_y: True
        size_hint_y: None
        # fill parent
        height: root.height
        size: root.size
        # on scroll start
        # on_scroll_start: root.on_scroll_start()
        # id: scroll_tool
        # on scroll stop
        # on_scroll_start: root.on_scroll_start()
        GridLayout:
            cols: 1
            size_hint_y: None
            height: self.minimum_height
            id: list_tool
            padding: 1
            spacing: 5
    BoxLayout:
        size_hint_y: None
        width: 400
        # fill the space
        height: 50
        canvas.before:
            Color:
                rgba: 0.6, 0.2, 0.2, 1
            Rectangle:
                pos: self.pos
                size: self.size
        Button:
            text: 'Search'
            # back ground image
            background_color: 0.678, 0.847, 0.902, 1
            # on_release: root.parent.manager.main_screen.ids.menu_bar.show_search()
            size_hint_x: 0.3
        Button:
            text: 'next'
            # back ground image
            background_color: 0.678, 0.847, 0.902, 1
            on_release: root.nextPage()
            size_hint_x: 0.3
        Button:
            text: 'previous'
            # redish background
            background_color: 0.678, 0.847, 0.902, 1
            on_release: root.previousPage()
            size_hint_x: 0.3

<LibraryTooltip>:
    size_hint: None, None
    size: 400, 200
    title: 'tooltip'
    auto_dismiss: False
    BoxLayout:
        orientation: 'vertical'
        ScrollView:
            pos: 0, 0
            scroll_y: 0
            scroll_type: ['bars', 'content']
            TextInput:
                multiline: True
                text: root.tooltip_text
                # light grey
                background_color: 0.8, 0.8, 0.8, 1
                readonly: True
        GridLayout:
            cols: 2
            rows: 1
            size_hint_y: None
            height: 30
            Button:
                text: 'OK'
                on_release: root.dismiss()
            # copy message to clipboard
            Button:
                text: 'Do not show again'
                on_release: root.do_not_show_again()

<FilterDatabase>:
    size_hint: None, None
    size: 400, 200
    title: 'Filter Database'
    auto_dismiss: False
    GridLayout:
        cols: 1
        rows: 3
        # BoxLayout:
        #    # check box
        #     CheckBox:
        #         id: check_box_article_id
        #         size_hint_x: 0.1
        #         # on_active: root.show_all()
        #     Label:
        #         text: 'By Article ID'
        #         size_hint_x: 0.9 
        BoxLayout:
            # by article title
            CheckBox:
                id: check_box_article_title
                size_hint_x: 0.1
                # on_active: root.show_all()
            Label:
                text: 'By Article Title'
                size_hint_x: 0.9
        GridLayout:
            cols: 3
            rows: 1
            size_hint_y: None
            height: 30
            Button:
                text: 'Filter'
                on_release: root.filterDatabase()
                size_hint_x: 0.3
            Button:
                text: 'Cancel'
                on_release: root.dismiss()
                size_hint_x: 0.3
<LoadDialog>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"
        FileChooserListView:
            id: filechooser
            # path: "/home/samman/Documents/MobileApplications/Learn/SciLibra"
            filters: ['*.bib', '*.txt']
        GridLayout:
            cols: 2
            rows: 1
            size_hint_y: None
            height: 30
            Button:
                text: "Cancel"
                on_release: root.cancel()

            Button:
                text: "Load"
                on_release: root.load(filechooser.path, filechooser.selection)

<EditScreen>:
    name: 'Edit'
    # labels and text boxes for article information
    article_info: article_info
    GridLayout:
        cols: 1
        rows: 3
        TextInput:
            id: article_info
            multiline: True
            text: 'Please select an article'
            # light grey
            background_color: 0.8, 0.8, 0.8, 1
        # box layout for available taggroups, and keywords
        BoxLayout:
            cols: 1
            rows: 2
            # take only 10% of the space
            size_hint_y: 0.1
            # two buttons for adding and removing taggroups, and keywords
            Button:
                text: 'Add Taggroup'
                # back ground image
                background_color: 0.678, 0.847, 0.902, 1
                on_release: root.choose_from_available_values('taggroups')
            Button:
                text: 'Add Keyword'
                # back ground image
                background_color: 0.678, 0.847, 0.902, 1
                on_release: root.choose_from_available_values('keywords')
        BoxLayout:
            size_hint_y: None
            height: 50
            width: 120
            # fill the space
            Button:
                # back ground image
                text: 'Update'
                #rgb(173,255,47)
                background_color: 0.678, 0.847, 0.902, 1
                on_release: root.update_article()
            Button:
                text: 'Cancel'
                #rgb(173,255,47)
                background_color: 0.678, 0.847, 0.902, 1
                on_release: root.manager.current = 'main'

<AvailableValue>:
    text: root.value
    # back color
    background_color: 0.678, 0.847, 0.902, 1
    
<AddAvailableValues>:
    size_hint: None, None
    size: 400, 400
    title: 'Add Available Values'
    auto_dismiss: False
    available_values: available_values
    GridLayout:
        cols:1
        rows:2
        GridLayout:
            cols: 2
            rows: 1
            BoxLayout:
                orientation: 'vertical'
                ScrollView:
                    pos: 0, 0
                    scroll_y: 1
                    scroll_type: ['bars', 'content']
                    canvas.before:
                        Color:
                            rgba: 0.6, 0.2, 0.2, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size
                    do_scroll_x: False
                    do_scroll_y: True
                    size: root.size
                    GridLayout:
                        cols: 1
                        size_hint_y: self.minimum_height
                        # height: self.minimum_height
                        id: available_values
                        padding: 1
                        spacing: 1
            BoxLayout:
                orientation: 'vertical'
                size_hint_y: None
                height: 100
                ScrollView:
                    pos: 0, 0
                    scroll_y: 1
                    scroll_type: ['bars', 'content']
                    canvas.before:
                        Color:
                            rgba: 0.6, 0.2, 0.2, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size
                    do_scroll_x: False
                    do_scroll_y: True
                    size: root.size
                    GridLayout:
                        cols: 1
                        size_hint_y: self.minimum_height
                        # height: self.minimum_height
                        # id: available_values
                        padding: 1
                        spacing: 1
                        Button:
                            text: 'Add'
                            # back ground image
                            background_color: 0.678, 0.847, 0.902, 1
        BoxLayout:
            size_hint_y: None
            height: 30
            Button:
                text: 'Add'
                on_release: root.addavailablevalues()
                size_hint_x: 0.3
            Button:
                text: 'Cancel'
                on_release: root.dismiss()
                size_hint_x: 0.3
<LoadProgressBar>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"
        ProgressBar:
            id: progress_bar
            max: 100
            value: 0
        Label:
            id: progress_label
            text: '0%'
        Button:
            text: "Cancel"
            on_release: root.cancel()
            


<UpdateFolderPath>:
    size_hint: None, None
    size: 400, 400
    title: 'Update Folder Path'
    auto_dismiss: False
    folder_paths: folder_paths
    BoxLayout:
        orientation: 'vertical'
        ScrollView:
            scroll_y: 0
            scroll_type: ['bars', 'content']
            TextInput:
                id: folder_paths
                multiline: True
                readonly: True
        GridLayout:
            cols: 3
            rows: 1
            size_hint_y: None
            height: 30
            Button:
                text: 'Add'
                on_release: root.selectfolder()
                size_hint_x: 0.3
            Button:
                text: 'Update'
                on_release: root.updatefolderpaths()
                size_hint_x: 0.3
            Button:
                text: 'Cancel'
                on_release: root.dismiss()
                size_hint_x: 0.3

<LoadFolderDialog>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"
        FileChooserListView:
            id: filechooser
            path: root.startPath
        BoxLayout:
            size_hint_y: None
            height: 30
            Button:
                text: "Cancel"
                on_release: root.cancel()
            Button:
                text: "Load"
                on_release: root.load(filechooser.path, filechooser.selection)
<SciLibraScreenManager>:
    MainScreen:
        id: main_screen
        name: 'main'
    EditScreen:
        id: Edit_screen
        name: 'Edit'
    SearchScreen:
        id: Search_screen
        name: 'search'